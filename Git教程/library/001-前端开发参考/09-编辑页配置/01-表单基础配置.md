# 表单部分配置

## 基础配置
```js
 dataModule:[{
     key: 'Edit_Basic_Info',
         module: [
              { name: '录入日期：', bindModel: 'item.OP_CREATE_DATE', type: 'date', format: 'yyyy/MM/dd', row: 10, textColSpan: 2, contentColSpan: 3, disabled: 'wtj_Disable' }
            ]
 }],
  pageModule: [{
      type: 'Edit_Custom', moduleTitle: '基础信息', dataModuleName: 'Edit_Basic_Info'
  }]
```

### 属性

| 参数          | 说明   | 类型  | 可选值  |默认值|
| ------------- |:------:| :-----:| :-----:| :-----:|
| `name `    | 名称 | string |--|--|
|  `bindModel` | 绑定的字段名  |  string |--|**必填**|
|  `type`   | input类型     |   string |`date`,`date3`,`text`,`tree`,`icon`,`radio`,`textarea`,`select`,`select3`,`attachment`,`hidden`,`multiselect` |text|
| `format `    | 过滤器 | string |--|`yyyy/MM/dd`|
| `bindDict_code `    | 字典项编码 | string |--|**type为select且dataSourceUrl不存在时必填**|
| `row `| 所处行用于排序 | number |--|**必填**|
| `textColSpan `| 当前行文字标题所占比例 | number |--|**必填**|
| `contentColSpan `| 当前行文本框所占比例 | number |--|**必填**|
| `disabled `| 只读属性 | boolean |`false`,`true`|`false`|

### 文本框类型
行内元素的属性由配置中的type决定，type属性包含了以下类型`date`,`date3`,`text`,`tree`,`icon`,`radio`,`textarea`,`select`,`select3`,`attachment`,`hidden`,`multiselect` 

* date：基础日期控件，需要加入属性format: 'yyyy/MM/dd'；
* date3：日期+时间控件，需要加入属性format: 'YYYY/MM/DD HH:mm:ss'
* tree：用于数据的树形展示，数据来源非组织机构树时需要提供dataSourceUrl属性用于提供请求地址。
* icon：展示一个图标，目前可选图标为search;
* select：下拉单选，需要提供字典项属性bindDict_code,如数据来源非字典项需要提供dataSourceUrl属性用于提供请求地址。
* select3：带查询功能的下拉单选，需要提供字典项属性bindDict_code,如数据来源非字典项需要提供dataSourceUrl属性用于提供请求地址。
* radion: 平铺形式的单选，需要提供字典项属性bindDict_code,如数据来源非字典项需要提供dataSourceUrl属性用于提供请求地址。
* multiselect：下拉多选，需要提供字典项属性bindDict_code,如数据来源非字典项需要提供dataSourceUrl属性用于提供请求地址。
* hidden：为true的时候对文本框隐藏
* attachment：用于行内附件(开发中)

## 功能配置
### 设置初始值及行隐藏
```js
init: {
        initEditName: 'DemoProblem',
        initPrimaryKey: 'PROBLEM_ID',//主键编号,
        initUrl: {//初始化Url
        },
        initParam: {
            editInitParam: [
                { key: 'item', value: '{"ORG_INSP_ID":"' + $localStorage["UserData"].ORG_ID + '","INSPECT_TIME":"' + (new Date()).getFullYear() + "/" + ((new Date()).getMonth() + 1) + "/" + (new Date()).getDate() + '","OP_CREATE_UNAME":"' + $localStorage["UserData"].USER_NAME + '"}', toJsonObj: true, isUseNewEdit: true }
            ],
            addInitParam: {
                "setBlockHide": { "Hide_Main_Attachments": true },
                "setRowVisible": {
                    "showRow_11": false, "showRow_4": false, "showRow_3": false
                }
            }
        },
        inUrlSumbit: {
            editInitSubmit: [{}]
        }
    }
```
这里`editInitParam`属性对应输入栏的默认值；`addInitParam`属性对应隐藏功能，当中`setBlockHide`为区块隐藏，`setRowVisible`为行隐藏。

### tab形式的展示风格
![](assets/001/09/01-1507877784000.png)

```js
pageModule: [{
      type: 'Edit_Custom',formTable:'true', moduleTitle: '基础信息', dataModuleName: 'Edit_Basic_Info'
  } ，{
      type: 'Edit_Custom_Attachment', formRelation: 'Edit_Basic_Info', moduleTitle: '基本信息附件', dataModuleName: 'Edit_Attachments'
    },
  ]
```
* `formTable`为`true`时按照tab风格进行表单展示，`formTable`默认为`true`，如不需要将此属性设置为`false`即可。
* 如需要关联附件则在附件配置对象属性里加入`formRelation`，其对应的是表单中的`dataModuleName`属性。

### 放大镜
![](assets/001/09/01-1507875052000.png)

```js
$scope.roleSearch = function (obj,scope) {
    scope.OpenModal("Modal_Head");
}
$scope.customfunction = [
{ "name": "roleSearch", "value": "roleSearch" }
];
......
 dataModule:[
  {
    key: 'Edit_Basic_Info',
    module: [
        { name: '放大镜', bindModel: 'item.FDJ_NAME', type: 'text', row: 6, textColSpan: 2, contentColSpan: 3, },
        { name: '', bindModel: 'item.FDJ_ID', type: 'hidden', row: 0, textColSpan: 0, contentColSpan: 0, placeholder: '隐藏文本' },
        { name: '', type: 'icon', iconType: 'search', row: 6, textColSpan: 0, contentColSpan: 1, title: '查询弹框', on_Change: "roleSearch()" },
    ]
   },
   {//负责人放大镜
    key: 'Modal_Head',
    module: {
        modalID: "Head",//弹框ID，同一个controller下，名称不能重复
        eipGridTable: [ 
            { name: 'ID', field: 'ROLE_ID', width: '0', isDelKey: true, disabled: true, visible: false },
            { name: '角色名称', field: 'ROLE_NAME' },
            { name: '角色备注', field: 'ROLE_DESC' },
        ],
        eipSimpleTable: [//默认简单查询 查询条件。
            { name: '角色名称', type: 'text', placeholder: '', ngModel: 'ROLE_NAME', groupOrder: 1 },
        ],
        initUrl: "UserMange/GetRoleListOutOfUser",//grid初始化及查询调用后台方法
        /*-------------------------------------弹出层相关配置-------------------------------------------*/
        width: 750,             //弹层的宽度
        saveAndClose: true,      //grid列表下是否显示关闭与保存（主要用于
        //采用键值对形式传入多个参数进行多个赋值
        setMultipleValue: {
            "ROLE_ID": "FDJ_ID",
            "ROLE_NAME": "FDJ_NAME"
        }
    }
}]
```
放大镜为查询操作,所以需要http请求，对应属性`initUrl`，`setMultipleValue`属性作用为传值匹配，这里可以将多个grid字段赋值给多个表单中的字段，不限制个数；当赋值了不存在的属性时会忽略此属性不做报错处理。

#### 通用的放大镜服务
```js
 $scope.OpenModal = function (dataModuleName, callback) {
    return eipOpenModal.openModal("subitem", $scope, dataModuleName, callback)
 };
```
任何指令如果需要用到放大镜的功能都可以通过增加`eipOpenModal`服务和`OpenModal`函数来实现;

### 设置属性只读
配置中的属性disabled可以通过true、false来控制，或者传入一个非布尔值来进行双向绑定，该值会作为eipform指令中作用域的属性使用。



