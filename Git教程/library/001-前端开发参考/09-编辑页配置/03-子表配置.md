# 子表配置
## 子表的基础配置
![](assets/001/09/03-1508204700000.png)

### code
```js
  //row 为当前行信息，scope为当前表单的作用域
  $scope.testEvent=function(row,scope){}
  $scope.customfunction = [
    { "name": "testEvent", "value": "testEvent" }
  ];
  ......
  dataModule: [
        {
            key: 'Edit_Rectify_Info',
            module: {
                eipGridTable: [
                    { name: '主键ID', field: 'REC_ID', visible: false, isDelKey: true },
                    { name: '序号', field: 'ROW_NUM', visible: true },
                    { name: '整改措施', field: 'REC_MEASURE', isDelArray: true, delShowName: true, isLink: true ,isLinkEvent:'testEvent'},
                    { name: '整改进度', field: 'REC_RATE' },
                    { name: '整改时间', field: 'REC_TIME', cellTemplate: { cell_date_format: '{{COL_FIELD|timeformat:"YYYY-MM-DD"}}' } },
                    { name: '负责人', field: 'REC_RESPONSE_USER',cellTemplate: { cell_magnifter_edit: 'ture' }, on_Change: "roleSearch()"},
                ]
            }
        }
    ],
    pageModule: [{
        type: 'Edit_SubUiTable', isSubTable:"false",isRowEdit: "ture", moduleTitle: '整改信息', dataModuleName: 'Edit_Rectify_Info', isHide: "Hide_Rectify_Info",  permissionActionName: 'GetPermission', editActionName: 'GetSingleRecByID', editSaveActionName: 'SaveRecInfo', delActionName: 'DeleteRec', modeModuleName: 'Edit_RectifyModule', modeTitle: '', gridDataName: 'item.DC_SYS_DEMO_PROBLEM_RECTIFY', gridDataTotal: 'item.DC_SYS_DEMO_PROBLEM_RECTIFY.total'
    },]       
```
### eipGridTable Attributes
| 参数          | 说明   | 类型  | 可选值  |默认值|
| ------------- |:------:| :-----:| :-----:| :-----:|
| `field `| 字段名(与后台接口字段保持统一) | string |--|**必填**|
| `visible `| 是否隐藏 | boolean |`false`,`true`|`false`|
| `isDelKey `| 是否主键字段 | boolean |`false`,`true`|`false`|
| `isLink` | 是否作为链接字段(默认触发编辑弹窗) | boolean |`false`,`true`|`false`|
| `isLinkEvent` | 链接事件| event |--|--|
| `cell_date_format` | 用于行编辑的控件类型选择| string |日期、下拉框、树、放大镜|--|

#### cell_date_format
此属性用于行编辑时不同控件的展示
* 日期控件：cellTemplate: { cell_date_format: '{{COL_FIELD|timeformat:"YYYY/MM/DD HH:mm"}}'} 
* 下拉框：cellTemplate: { cell_dict_Code: 'DICT_REC_CONTENT_TYPE' } }
* 树：cellTemplate: { cell_tree_edit: true } 
* 放大镜：cellTemplate: { cell_magnifter_edit: ture},on_Change: "roleSearch()"

#### isLink
此属性需要的时候配置，配置后该配置的字段会作为链接字段使用，默认当`isLinkEvent`不存在的时候，链接字段触发的事件为编辑页弹窗;当需要做特殊的跳转等用途时可加入`isLinkEvent`属性，此属性值对应一个自定义的函数，此函数包含两个参数，第一个参数为当前链接行的信息，第二个参数为当前编辑页表单的作用域`scope`对象。


### pageModule Attributes
| 参数          | 说明   | 类型  | 可选值  |默认值|
| ------------- |:------:| :-----:| :-----:| :-----:|
| `type `| 子表类型 | string |`Edit_SubUiTable`、`Edit_SubTable`、`Popup_Grid`|**必填**|
| `isRowEdit `| 设置该字段不可编辑 | boolean |`false`,`true`|`false`|
| `isSubTable `| 是否关闭tab展示风格 | boolean |`false`,`true`|`false`|
| `moduleTitle `| 子表标题 | string |--|--|
| `dataModuleName` | 对应的数据模型 | string |--|**必填**|
| `isHide` | 是否隐藏| boolean |--|--|
| `editActionName` | 获取子表单条数据(用于编辑)| string |--|**必填**|
| `editSaveActionName` | 子表编辑保存| string |--|**必填**|
| `delActionName` | 单条数据的删除| string |--|**必填**|
| `permissionActionName` | 子表操作权限控制| string |--|**必填**|
| `modeModuleName` | 对应的弹窗数据模型 | string |--|**必填**|
| `modeTitle `| 弹窗标题 | string |--|--|
| `gridDataName `| 子表存储数据用的字段名(给后台~用于标示) | string |--|--|
| `gridDataTotal `| 子表页数字段 | string |--|--|


## 子表弹窗
![](assets/001/09/03-1508207149000.png)


```js
    dataModule: [
          {//整改编辑弹出框
            key: 'Edit_RectifyModule',
            module: [
                { name: '整改措施', bindModel: 'subitem.REC_MEASURE', type: 'text', row: 1, textColSpan: 2, contentColSpan: 4, placeholder: '整改措施' },
                { name: '整改进度(%)', bindModel: 'subitem.REC_RATE', type: 'text', placeholder: '整改进度(0-100)',isRowEdit:true, row: 1, textColSpan: 2, contentColSpan: 4 },
                { name: '整改时间', bindModel: 'subitem.REC_TIME', type: 'date', format: 'yyyy/MM/dd', row: 2, textColSpan: 2, contentColSpan: 4 },
                { name: '负责人', bindModel: 'subitem.REC_RESPONSE_USER', type: 'text', row: 2, textColSpan: 2, contentColSpan: 4, placeholder: '负责人' },
            ],
            //测试子表弹窗带grid
            moduleGrid: {
                eipGridTable: [
                    { name: '主键ID', field: 'REC_CONTENT_ID', visible: false, isDelKey: true },
                    { name: '整改内容', field: 'REC_CONTENT' },
                    { name: '内容录入日期', field: 'REC_CONTENT_TIME', cellTemplate: { cell_date_format: '{{COL_FIELD|timeformat:"YYYY/MM/DD HH:mm"}}' } },
                    { name: '内容类型', field: 'DICT_REC_CONTENT_TYPE', cellTemplate: { cell_dict_Code: 'DICT_REC_CONTENT_TYPE' } },

                ],
                tableName: "DC_SYS_DEMO_REC_CONTENT",
                tableUrl: "DemoProblem/GetRecContentList"
            }
        }]
```
### 弹窗中的表单部分
弹窗的表单部分与编辑页表单配置完全一致，配置时可参考表单的基础配置，

### 弹窗中的grid表格
此配置为可选配置，弹窗`eipGridTable`里的属性配置与子表的配置方式一致，需要注意的是在`moduleGrid`里需要注明用到的表名和请求的地址，两个属性分别是`tableName`,`tableUrl`

### 弹窗中的放大镜
放大镜的配置方法与表单的配置方法一致。